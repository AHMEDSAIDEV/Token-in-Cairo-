<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Standard AccounT ðŸš§ - The Starknet Book</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body>
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var html = document.querySelector('html');
            var sidebar = null;
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="title-page.html">The Starknet Book</a></li><li class="chapter-item expanded affix "><a href="ch00-00-introduction.html">Introduction</a></li><li class="chapter-item expanded "><a href="ch01-00-getting-started.html"><strong aria-hidden="true">1.</strong> Getting Started</a></li><li class="chapter-item expanded "><a href="ch02-00-starknet-tooling.html"><strong aria-hidden="true">2.</strong> Tooling</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="ch02-01-basic-installation.html"><strong aria-hidden="true">2.1.</strong> Basic Installation</a></li><li class="chapter-item expanded "><a href="ch02-02-compile-deploy-interact.html"><strong aria-hidden="true">2.2.</strong> Compile, Deploy, Interact</a></li><li class="chapter-item expanded "><a href="ch02-03-scarb.html"><strong aria-hidden="true">2.3.</strong> Scarb: The Package Manager</a></li><li class="chapter-item expanded "><a href="ch02-04-starkli.html"><strong aria-hidden="true">2.4.</strong> Starkli: A CLI interface ðŸš§</a></li><li class="chapter-item expanded "><a href="ch02-05-katana.html"><strong aria-hidden="true">2.5.</strong> Katana: A Local Node</a></li><li class="chapter-item expanded "><a href="ch02-06-starknet-devnet.html"><strong aria-hidden="true">2.6.</strong> Starknet Devnet ðŸš§</a></li><li class="chapter-item expanded "><a href="ch02-07-starknet-js.html"><strong aria-hidden="true">2.7.</strong> Starknet-js: Javascript SDK</a></li><li class="chapter-item expanded "><a href="ch02-08-starknet-react.html"><strong aria-hidden="true">2.8.</strong> Starknet-React: React Integration</a></li><li class="chapter-item expanded "><a href="ch02-09-starknet-py.html"><strong aria-hidden="true">2.9.</strong> Starknet-py: Python SDK ðŸš§</a></li><li class="chapter-item expanded "><a href="ch02-10-starknet-rs.html"><strong aria-hidden="true">2.10.</strong> Starknet-rs: Rust SDK ðŸš§</a></li><li class="chapter-item expanded "><a href="ch02-11-foundry-cast.html"><strong aria-hidden="true">2.11.</strong> Foundry Cast: Interacting with Starknet ðŸš§</a></li><li class="chapter-item expanded "><a href="ch02-12-foundry-forge.html"><strong aria-hidden="true">2.12.</strong> Foundry Forge: Testing ðŸš§</a></li></ol></li><li class="chapter-item expanded "><a href="ch03-00-architecture.html"><strong aria-hidden="true">3.</strong> Architecture</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="ch03-01-transactions.html"><strong aria-hidden="true">3.1.</strong> Transactions</a></li><li class="chapter-item expanded "><a href="ch03-02-sequencers.html"><strong aria-hidden="true">3.2.</strong> Sequencers</a></li><li class="chapter-item expanded "><a href="ch03-03-provers.html"><strong aria-hidden="true">3.3.</strong> Provers ðŸš§</a></li><li class="chapter-item expanded "><a href="ch03-04-nodes.html"><strong aria-hidden="true">3.4.</strong> Nodes ðŸš§</a></li><li class="chapter-item expanded "><a href="ch03-05-layer-3.html"><strong aria-hidden="true">3.5.</strong> Layer 3 and App Chains ðŸš§  </a></li><li class="chapter-item expanded "><a href="ch03-06-solidity-verifier.html"><strong aria-hidden="true">3.6.</strong> Solidity Verifier ðŸš§</a></li><li class="chapter-item expanded "><a href="ch03-07-decentralization.html"><strong aria-hidden="true">3.7.</strong> Decentralization ðŸš§</a></li></ol></li><li class="chapter-item expanded "><a href="ch04-00-account-abstraction.html"><strong aria-hidden="true">4.</strong> Account Abstraction</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="ch04-01-accounts.html"><strong aria-hidden="true">4.1.</strong> Accounts</a></li><li class="chapter-item expanded "><a href="ch04-02-hello-account.html"><strong aria-hidden="true">4.2.</strong> Hello, Account! ðŸš§</a></li><li class="chapter-item expanded "><a href="ch04-03-standard-account.html" class="active"><strong aria-hidden="true">4.3.</strong> Standard AccounT ðŸš§</a></li><li class="chapter-item expanded "><a href="ch04-04-examples.html"><strong aria-hidden="true">4.4.</strong> Examples</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="ch04-04-01-multicaller.html"><strong aria-hidden="true">4.4.1.</strong> Multicaller ðŸš§</a></li><li class="chapter-item expanded "><a href="ch04-04-02-multisig.html"><strong aria-hidden="true">4.4.2.</strong> Multisig ðŸš§</a></li><li class="chapter-item expanded "><a href="ch04-04-03-auto-payments.html"><strong aria-hidden="true">4.4.3.</strong> Auto-Payments ðŸš§</a></li><li class="chapter-item expanded "><a href="ch04-04-04-alternative-signature-schemes.html"><strong aria-hidden="true">4.4.4.</strong> Alternative Signature Schemes ðŸš§</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="ch05-00-starks.html"><strong aria-hidden="true">5.</strong> STARKs ðŸš§</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="ch05-01-basics.html"><strong aria-hidden="true">5.1.</strong> Basics ðŸš§</a></li><li class="chapter-item expanded "><a href="ch05-02-math-primer.html"><strong aria-hidden="true">5.2.</strong> Math Primer ðŸš§</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="ch05-02-01-number-theory.html"><strong aria-hidden="true">5.2.1.</strong> Number Theory ðŸš§</a></li><li class="chapter-item expanded "><a href="ch05-02-02-geometry.html"><strong aria-hidden="true">5.2.2.</strong> Geometry ðŸš§</a></li><li class="chapter-item expanded "><a href="ch05-02-03-cryptographic-primitives.html"><strong aria-hidden="true">5.2.3.</strong> Cryptographic Primitives ðŸš§</a></li></ol></li><li class="chapter-item expanded "><a href="ch05-03-arithimization.html"><strong aria-hidden="true">5.3.</strong> Arithimization ðŸš§</a></li><li class="chapter-item expanded "><a href="ch05-04-low-degree-testing.html"><strong aria-hidden="true">5.4.</strong> Low Degree Testing ðŸš§</a></li><li class="chapter-item expanded "><a href="ch05-05-fri-protocol.html"><strong aria-hidden="true">5.5.</strong> FRI Protocol ðŸš§</a></li><li class="chapter-item expanded "><a href="ch05-06-efficient-starks.html"><strong aria-hidden="true">5.6.</strong> Efficient STARKs</a></li><li class="chapter-item expanded "><a href="ch05-07-starks-protocol-python.html"><strong aria-hidden="true">5.7.</strong> STARKs Protocol (Python) ðŸš§</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="ch05-07-01-trace-low-degree-extension-python.html"><strong aria-hidden="true">5.7.1.</strong> Trace/Low Degree Extension ðŸš§</a></li><li class="chapter-item expanded "><a href="ch05-07-02-constraints-python.html"><strong aria-hidden="true">5.7.2.</strong> Constraints ðŸš§</a></li><li class="chapter-item expanded "><a href="ch05-07-03-fri-commitments-python.html"><strong aria-hidden="true">5.7.3.</strong> FRI Commitments ðŸš§</a></li><li class="chapter-item expanded "><a href="ch05-07-04-query-phase-python.html"><strong aria-hidden="true">5.7.4.</strong> Query Phase ðŸš§</a></li></ol></li><li class="chapter-item expanded "><a href="ch05-08-starks-protocol-rust.html"><strong aria-hidden="true">5.8.</strong> STARKs Protocol (Rust) ðŸš§</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="ch05-08-01-trace-low-degree-extension-rust.html"><strong aria-hidden="true">5.8.1.</strong> Trace/Low Degree Extension ðŸš§</a></li><li class="chapter-item expanded "><a href="ch05-08-02-constraints-rust.html"><strong aria-hidden="true">5.8.2.</strong> Constraints ðŸš§</a></li><li class="chapter-item expanded "><a href="ch05-08-03-fri-commitments-rust.html"><strong aria-hidden="true">5.8.3.</strong> FRI Commitments ðŸš§</a></li><li class="chapter-item expanded "><a href="ch05-08-04-query-phase-rust.html"><strong aria-hidden="true">5.8.4.</strong> Query Phase ðŸš§</a></li></ol></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">The Starknet Book</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="standard-account-contract"><a class="header" href="#standard-account-contract">Standard Account Contract</a></h1>
<p><strong>NOTE:</strong>
<strong>THIS CHAPTER NEEDS TO BE UPDATED TO REFLECT THE NEW SYNTAX FOR ACCOUNT CONTRACTS. PLEASE DO NOT USE THIS CHAPTER AS A REFERENCE UNTIL THIS NOTE IS REMOVED.</strong></p>
<p><strong>CONTRIBUTE: This subchapter is missing an example of declaration, deployment and interaction with the contract. We would love to see your contribution! Please submit a PR.</strong></p>
<p>In this chapter, we build upon our exploration of account contracts in
Starknet by introducing a more complex account contract. This Standard
Account Contract includes additional features such as signature
validation, providing a more robust example of an account contract in
Cairo language. You can find the full code for this contract in the Book
repository (todo: add link). You can interact and compile the contract
using Scarb (review the Scarb subchapter in Chapter 2 of the Book for
more information).</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>    // Import necessary modules and traits
    use serde::Serde;
    use starknet::ContractAddress;
    use array::ArrayTrait;
    use array::SpanTrait;
    use option::OptionTrait;

    // Define the Account contract
    #[account_contract]
    mod Account {
        use array::ArrayTrait;
        use array::SpanTrait;
        use box::BoxTrait;
        use ecdsa::check_ecdsa_signature;
        use option::OptionTrait;
        use super::Call;
        use starknet::ContractAddress;
        use zeroable::Zeroable;
        use serde::ArraySerde;

        // Define the contract's storage variables
        struct Storage {
            public_key: felt252
        }

        // Constructor function for initializing the contract
        #[constructor]
        fn constructor(public_key_: felt252) {
            public_key::write(public_key_);
        }

        // Internal function to validate the transaction signature
        fn validate_transaction() -&gt; felt252 {
            let tx_info = starknet::get_tx_info().unbox(); // Unbox transaction info
            let signature = tx_info.signature; // Extract signature
            assert(signature.len() == 2_u32, 'INVALID_SIGNATURE_LENGTH'); // Check signature length

            // Verify ECDSA signature
            assert(
                check_ecdsa_signature(
                    message_hash: tx_info.transaction_hash,
                    public_key: public_key::read(),
                    signature_r: *signature[0_u32],
                    signature_s: *signature[1_u32],
                ),
                'INVALID_SIGNATURE',
            );

            starknet::VALIDATED // Return validation status
        }

        // Validate contract deployment
        #[external]
        fn __validate_deploy__(
            class_hash: felt252, contract_address_salt: felt252, public_key_: felt252
        ) -&gt; felt252 {
            validate_transaction()
        }

        // Validate contract declaration
        #[external]
        fn __validate_declare__(class_hash: felt252) -&gt; felt252 {
            validate_transaction()
        }

        // Validate contract execution
        #[external]
        fn __validate__(
            contract_address: ContractAddress, entry_point_selector: felt252, calldata: Array&lt;felt252&gt;
        ) -&gt; felt252 {
            validate_transaction()
        }

        // Execute a contract call
        #[external]
        #[raw_output]
        fn __execute__(mut calls: Array&lt;Call&gt;) -&gt; Span&lt;felt252&gt; {
            // Validate caller
            assert(starknet::get_caller_address().is_zero(), 'INVALID_CALLER');

            let tx_info = starknet::get_tx_info().unbox(); // Unbox transaction info
            assert(tx_info.version != 0, 'INVALID_TX_VERSION');

            assert(calls.len() == 1_u32, 'MULTI_CALL_NOT_SUPPORTED'); // Only single calls are supported
            let Call{to, selector, calldata } = calls.pop_front().unwrap();

            // Call the target contract
            starknet::call_contract_syscall(
                address: to, entry_point_selector: selector, calldata: calldata.span()
            ).unwrap_syscall()
        }
    }

    // Define the Call struct
    #[derive(Drop, Serde)]
    struct Call {
        to: ContractAddress,
        selector: felt252,
        calldata: Array&lt;felt252&gt;
    }
<span class="boring">}</span></code></pre></pre>
<h2 id="grasping-ecdsa-signature"><a class="header" href="#grasping-ecdsa-signature">Grasping ECDSA Signature</a></h2>
<p>Elliptic Curve Digital Signature Algorithm (ECDSA) is a cryptographic
protocol extensively utilized across various blockchains to ensure data
integrity and verify the senderâ€™s authenticity. As a variant of the
Digital Signature Algorithm (DSA), ECDSA leverages elliptic curve
cryptography, offering superior security with shorter keys than the
traditional DSA.</p>
<p>An ECDSA signature comprises two components, commonly referred to as <em>r</em>
and <em>s</em>. These two values, generated using the signerâ€™s private key and
the hash of the message (or transaction) being signed, collectively form
the signature for a given input.</p>
<h3 id="deciphering-signature_r-and-signature_s"><a class="header" href="#deciphering-signature_r-and-signature_s">Deciphering signature_r and signature_s</a></h3>
<p>Within the context of the Standard Account Contract, <em>signature_r</em> and
<em>signature_s</em> represent the two constituents of the ECDSA signature.
These are utilized in the <em>check_ecdsa_signature</em> function to
authenticate the transactionâ€™s legitimacy.</p>
<ul>
<li>
<p><code>signature_r (r)</code>: A random number generated during the signing
process, unique for each signature. Reusing <em>r</em> across different
messages may lead to private key exposure.</p>
</li>
<li>
<p><code>signature_s (s)</code>: This is computed using <em>r</em>, the private key, and
the hash of the message. Like <em>r</em>, <em>s</em> is also unique for each
signature.</p>
</li>
</ul>
<p>The function <em>check_ecdsa_signature</em> takes these two values, the
public key of the signer, and the hash of the message to authenticate
the signature. A valid signature indicates that the message was indeed
signed by the private key owner and remains unaltered.</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>            assert(
                check_ecdsa_signature(
                    message_hash: tx_info.transaction_hash,
                    public_key: public_key::read(),
                    signature_r: *signature[0_u32],
                    signature_s: *signature[1_u32],
                ),
                'INVALID_SIGNATURE',
            );
<span class="boring">}</span></code></pre></pre>
<p>The above code snippet employs <em>check_ecdsa_signature</em> function to
assert the legitimacy of the transaction signature. If the signature is
not valid, the assertion fails, returning <em>INVALID_SIGNATURE</em>.</p>
<h2 id="contract-anatomy"><a class="header" href="#contract-anatomy">Contract Anatomy</a></h2>
<h3 id="storage"><a class="header" href="#storage">Storage</a></h3>
<p>In the standard account contract, we declare a single storage variable:
<em>public_key</em>. This assists in transaction signature validation. The
public key, stored as a <em>felt252</em> (a 252-bit unsigned integer), is
written to the storage in the constructor function and is accessed from
the storage in the <em>validate_transaction</em> function.</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>    struct Storage {
        public_key: felt252
    }
<span class="boring">}</span></code></pre></pre>
<h3 id="constructor"><a class="header" href="#constructor">Constructor</a></h3>
<p>The constructor function serves to initialize the contract, storing the
supplied public key in the contractâ€™s storage.</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>    #[constructor]
    fn constructor(public_key_: felt252) {
        public_key::write(public_key_);
    }
<span class="boring">}</span></code></pre></pre>
<h3 id="validate_transaction"><a class="header" href="#validate_transaction"><code>validate_transaction</code></a></h3>
<p>This internal function validates the transaction signature. It retrieves
the signature from the transaction info, checks its length, and verifies
the ECDSA signature. If the signature is legitimate, it returns
starknet::VALIDATED, otherwise an error. This function is invoked by
<strong>validate_deploy</strong>, <strong>validate_declare</strong>, and <strong>validate</strong> functions.</p>
<p>The inclusion of this function is optional. If transaction signature
validation is not required, it can be omitted. However, its inclusion in
your account contract is advised to ensure transaction validity and to
facilitate its reuse in all three validation functions.</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>    fn validate_transaction() -&gt; felt252 {
            let tx_info = starknet::get_tx_info().unbox(); // Unbox transaction info
            let signature = tx_info.signature; // Extract signature
            assert(signature.len() == 2_u32, 'INVALID_SIGNATURE_LENGTH'); // Check signature length

            // Verify ECDSA signature
            assert(
                check_ecdsa_signature(
                    message_hash: tx_info.transaction_hash,
                    public_key: public_key::read(),
                    signature_r: *signature[0_u32],
                    signature_s: *signature[1_u32],
                ),
                'INVALID_SIGNATURE',
            );

            starknet::VALIDATED // Return validation status
        }
<span class="boring">}</span></code></pre></pre>
<h3 id="call-struct"><a class="header" href="#call-struct">Call Struct</a></h3>
<p>The Call struct outlines the parameters required for a contract call.
These parameters comprise the target contract address (to), the function
to be called (selector), and the functionâ€™s arguments (calldata). The
Call struct is utilized in the <em>execute</em> function.</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>    #[derive(Drop, Serde)]
    struct Call {
        to: ContractAddress,
        selector: felt252,
        calldata: Array&lt;felt252&gt;
    }
<span class="boring">}</span></code></pre></pre>
<h3 id="execute"><a class="header" href="#execute">execute</a></h3>
<p>This external function triggers a transaction post successful
validation. It ensures the callerâ€™s validity, checks for a non-zero
transaction version, and supports only single calls. Post validation, it
forwards the call to the target contract. The contract creator can
incorporate multiple calls to different contracts or the same contract
(multicall) within this function. The function returns the output from
the target contract.</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>        #[external]
        #[raw_output]
        fn __execute__(mut calls: Array&lt;Call&gt;) -&gt; Span&lt;felt252&gt; {
            // Validate caller
            assert(starknet::get_caller_address().is_zero(), 'INVALID_CALLER');

            let tx_info = starknet::get_tx_info().unbox(); // Unbox transaction info
            assert(tx_info.version != 0, 'INVALID_TX_VERSION');

            assert(calls.len() == 1_u32, 'MULTI_CALL_NOT_SUPPORTED'); // Only single calls are supported
            let Call{to, selector, calldata } = calls.pop_front().unwrap();

            // Call the target contract
            starknet::call_contract_syscall(
                address: to, entry_point_selector: selector, calldata: calldata.span()
            ).unwrap_syscall()
        }
<span class="boring">}</span></code></pre></pre>
<h2 id="improvements-to-the-standard-account-contract"><a class="header" href="#improvements-to-the-standard-account-contract">Improvements to the Standard Account Contract</a></h2>
<p>The implementation of the Standard Account Contract has a few
limitations:</p>
<ul>
<li>
<p>It currently supports only single calls. We could support multicalls
to improve the flexibility and utility of the contract.</p>
</li>
<li>
<p>The ECDSA signature algorithm, while secure, can be computationally
intensive. Future versions could explore using more efficient
signature algorithms, such as Schnorr or BLS. Or quantum-resistant
signature algorithms, such as the STARKs.</p>
</li>
</ul>
<p>Despite these limitations, the Standard Account Contract provides a
robust and secure foundation for creating and interacting with smart
contracts on Starknet.</p>
<h2 id="declaring-and-deploying-the-hello-world-account-contract"><a class="header" href="#declaring-and-deploying-the-hello-world-account-contract">Declaring and Deploying the Hello World Account Contract</a></h2>
<p>This time we have a constructor function that takes the public key as an
argument. We need to generate a private key with the corresponding
public key.</p>
<p>TODO: add section on how to generate a private key and public key.</p>
<ul>
<li>Export the required environment variables:</li>
</ul>
<!-- -->
<pre><code>export STARKNET_NETWORK=alpha-goerli
export STARKNET_WALLET=starkware.starknet.wallets.open_zeppelin.OpenZeppelinAccount
</code></pre>
<ul>
<li>Declare the contract (since the contract is already declared, you
can skip this step. If you want to declare it anyway, run the
following command but you will receive an error):</li>
</ul>
<!-- -->
<pre><code>starknet declare --contract target/release/starknetbook_chapter_7_Account.json --account vote_admin --max_fee 100000000000000000
</code></pre>
<p>The class hash is:
0x05501f7806d3d11cab101e19001e409dd4760200c2da2fe03761750f66e4a5e1</p>
<ul>
<li>Deploy the contract:</li>
</ul>
<p>TODO: add section on how to deploy the contract.</p>
<p>Elliptic Curve Digital Signature Algorithm (ECDSA) is a popular choice
for ensuring data integrity and sender authenticity in blockchain
networks, but itâ€™s not the only option. Other alternatives include:</p>
<ul>
<li>
<p>EdDSA (Edwards-curve Digital Signature Algorithm): EdDSA is another
form of elliptic curve cryptography that is designed to be faster
and more secure than ECDSA. EdDSA uses twisted Edwards curves, which
have strong security properties and allow for more efficient
computations. An example of EdDSA in use is Monero.</p>
</li>
<li>
<p>Schnorr Signatures: Schnorr signatures offer a level of security
similar to ECDSA but with shorter signatures. They have the
additional property of being linear, which allows for signature
aggregation and multi-signatures. This can lead to increased
efficiency and privacy. Bitcoin developers have proposed adding
Schnorr signatures to the Bitcoin protocol with the Taproot upgrade.</p>
</li>
<li>
<p>RSA (Rivestâ€“Shamirâ€“Adleman): RSA is an older cryptographic algorithm
that is widely used for secure data transmission. However, RSA
requires larger key sizes for equivalent security levels, making it
less efficient than elliptic curve techniques. RSA is not commonly
used in modern blockchain systems, but it is still used in many
traditional secure communication protocols.</p>
</li>
<li>
<p>BLS (Boneh-Lynn-Shacham) Signatures: BLS signatures, like Schnorr,
allow for signature aggregation, making them useful in systems that
require a large number of signatures. This property makes BLS
signatures particularly useful for consensus algorithms in
distributed systems and blockchains, such as Ethereum 2.0.</p>
</li>
<li>
<p>Post-Quantum Cryptography: With the advent of quantum computing,
researchers are developing new cryptographic algorithms that are
resistant to quantum attacks. One example are the STARKs used in
Starknet.</p>
</li>
</ul>
<p>Each of these alternatives has its strengths and weaknesses in terms of
security, efficiency, complexity, and mathematical properties.</p>
<h2 id="summary"><a class="header" href="#summary">Summary</a></h2>
<p>In this chapter, we expanded on our understanding of account contracts
in Starknet by examining a more complex &quot;Standard Account Contract&quot;. We
dove into the various components of the contract and learned how they
work together to validate and execute transactions.</p>
<p>The Book is a community-driven effort created for the community.</p>
<ul>
<li>
<p>If youâ€™ve learned something, or not, please take a moment to provide
feedback through <a href="https://a.sprig.com/WTRtdlh2VUlja09lfnNpZDo4MTQyYTlmMy03NzdkLTQ0NDEtOTBiZC01ZjAyNDU0ZDgxMzU=">this 3-question
survey</a>.</p>
</li>
<li>
<p>If you discover any errors or have additional suggestions, donâ€™t
hesitate to open an <a href="https://github.com/starknet-edu/starknetbook/issues">issue on our GitHub
repository</a>.</p>
</li>
</ul>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="ch04-02-hello-account.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next" href="ch04-04-examples.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="ch04-02-hello-account.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next" href="ch04-04-examples.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
