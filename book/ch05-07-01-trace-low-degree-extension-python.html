<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Trace/Low Degree Extension ðŸš§ - The Starknet Book</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body>
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var html = document.querySelector('html');
            var sidebar = null;
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="title-page.html">The Starknet Book</a></li><li class="chapter-item expanded affix "><a href="ch00-00-introduction.html">Introduction</a></li><li class="chapter-item expanded "><a href="ch01-00-getting-started.html"><strong aria-hidden="true">1.</strong> Getting Started</a></li><li class="chapter-item expanded "><a href="ch02-00-starknet-tooling.html"><strong aria-hidden="true">2.</strong> Tooling</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="ch02-01-basic-installation.html"><strong aria-hidden="true">2.1.</strong> Basic Installation</a></li><li class="chapter-item expanded "><a href="ch02-02-compile-deploy-interact.html"><strong aria-hidden="true">2.2.</strong> Compile, Deploy, Interact</a></li><li class="chapter-item expanded "><a href="ch02-03-scarb.html"><strong aria-hidden="true">2.3.</strong> Scarb: The Package Manager</a></li><li class="chapter-item expanded "><a href="ch02-04-starkli.html"><strong aria-hidden="true">2.4.</strong> Starkli: A CLI interface ðŸš§</a></li><li class="chapter-item expanded "><a href="ch02-05-katana.html"><strong aria-hidden="true">2.5.</strong> Katana: A Local Node</a></li><li class="chapter-item expanded "><a href="ch02-06-starknet-devnet.html"><strong aria-hidden="true">2.6.</strong> Starknet Devnet ðŸš§</a></li><li class="chapter-item expanded "><a href="ch02-07-starknet-js.html"><strong aria-hidden="true">2.7.</strong> Starknet-js: Javascript SDK</a></li><li class="chapter-item expanded "><a href="ch02-08-starknet-react.html"><strong aria-hidden="true">2.8.</strong> Starknet-React: React Integration</a></li><li class="chapter-item expanded "><a href="ch02-09-starknet-py.html"><strong aria-hidden="true">2.9.</strong> Starknet-py: Python SDK ðŸš§</a></li><li class="chapter-item expanded "><a href="ch02-10-starknet-rs.html"><strong aria-hidden="true">2.10.</strong> Starknet-rs: Rust SDK ðŸš§</a></li><li class="chapter-item expanded "><a href="ch02-11-foundry-cast.html"><strong aria-hidden="true">2.11.</strong> Foundry Cast: Interacting with Starknet ðŸš§</a></li><li class="chapter-item expanded "><a href="ch02-12-foundry-forge.html"><strong aria-hidden="true">2.12.</strong> Foundry Forge: Testing ðŸš§</a></li></ol></li><li class="chapter-item expanded "><a href="ch03-00-architecture.html"><strong aria-hidden="true">3.</strong> Architecture</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="ch03-01-transactions.html"><strong aria-hidden="true">3.1.</strong> Transactions</a></li><li class="chapter-item expanded "><a href="ch03-02-sequencers.html"><strong aria-hidden="true">3.2.</strong> Sequencers</a></li><li class="chapter-item expanded "><a href="ch03-03-provers.html"><strong aria-hidden="true">3.3.</strong> Provers ðŸš§</a></li><li class="chapter-item expanded "><a href="ch03-04-nodes.html"><strong aria-hidden="true">3.4.</strong> Nodes ðŸš§</a></li><li class="chapter-item expanded "><a href="ch03-05-layer-3.html"><strong aria-hidden="true">3.5.</strong> Layer 3 and App Chains ðŸš§  </a></li><li class="chapter-item expanded "><a href="ch03-06-solidity-verifier.html"><strong aria-hidden="true">3.6.</strong> Solidity Verifier ðŸš§</a></li><li class="chapter-item expanded "><a href="ch03-07-decentralization.html"><strong aria-hidden="true">3.7.</strong> Decentralization ðŸš§</a></li></ol></li><li class="chapter-item expanded "><a href="ch04-00-account-abstraction.html"><strong aria-hidden="true">4.</strong> Account Abstraction</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="ch04-01-accounts.html"><strong aria-hidden="true">4.1.</strong> Accounts</a></li><li class="chapter-item expanded "><a href="ch04-02-hello-account.html"><strong aria-hidden="true">4.2.</strong> Hello, Account! ðŸš§</a></li><li class="chapter-item expanded "><a href="ch04-03-standard-account.html"><strong aria-hidden="true">4.3.</strong> Standard AccounT ðŸš§</a></li><li class="chapter-item expanded "><a href="ch04-04-examples.html"><strong aria-hidden="true">4.4.</strong> Examples</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="ch04-04-01-multicaller.html"><strong aria-hidden="true">4.4.1.</strong> Multicaller ðŸš§</a></li><li class="chapter-item expanded "><a href="ch04-04-02-multisig.html"><strong aria-hidden="true">4.4.2.</strong> Multisig ðŸš§</a></li><li class="chapter-item expanded "><a href="ch04-04-03-auto-payments.html"><strong aria-hidden="true">4.4.3.</strong> Auto-Payments ðŸš§</a></li><li class="chapter-item expanded "><a href="ch04-04-04-alternative-signature-schemes.html"><strong aria-hidden="true">4.4.4.</strong> Alternative Signature Schemes ðŸš§</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="ch05-00-starks.html"><strong aria-hidden="true">5.</strong> STARKs ðŸš§</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="ch05-01-basics.html"><strong aria-hidden="true">5.1.</strong> Basics ðŸš§</a></li><li class="chapter-item expanded "><a href="ch05-02-math-primer.html"><strong aria-hidden="true">5.2.</strong> Math Primer ðŸš§</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="ch05-02-01-number-theory.html"><strong aria-hidden="true">5.2.1.</strong> Number Theory ðŸš§</a></li><li class="chapter-item expanded "><a href="ch05-02-02-geometry.html"><strong aria-hidden="true">5.2.2.</strong> Geometry ðŸš§</a></li><li class="chapter-item expanded "><a href="ch05-02-03-cryptographic-primitives.html"><strong aria-hidden="true">5.2.3.</strong> Cryptographic Primitives ðŸš§</a></li></ol></li><li class="chapter-item expanded "><a href="ch05-03-arithimization.html"><strong aria-hidden="true">5.3.</strong> Arithimization ðŸš§</a></li><li class="chapter-item expanded "><a href="ch05-04-low-degree-testing.html"><strong aria-hidden="true">5.4.</strong> Low Degree Testing ðŸš§</a></li><li class="chapter-item expanded "><a href="ch05-05-fri-protocol.html"><strong aria-hidden="true">5.5.</strong> FRI Protocol ðŸš§</a></li><li class="chapter-item expanded "><a href="ch05-06-efficient-starks.html"><strong aria-hidden="true">5.6.</strong> Efficient STARKs</a></li><li class="chapter-item expanded "><a href="ch05-07-starks-protocol-python.html"><strong aria-hidden="true">5.7.</strong> STARKs Protocol (Python) ðŸš§</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="ch05-07-01-trace-low-degree-extension-python.html" class="active"><strong aria-hidden="true">5.7.1.</strong> Trace/Low Degree Extension ðŸš§</a></li><li class="chapter-item expanded "><a href="ch05-07-02-constraints-python.html"><strong aria-hidden="true">5.7.2.</strong> Constraints ðŸš§</a></li><li class="chapter-item expanded "><a href="ch05-07-03-fri-commitments-python.html"><strong aria-hidden="true">5.7.3.</strong> FRI Commitments ðŸš§</a></li><li class="chapter-item expanded "><a href="ch05-07-04-query-phase-python.html"><strong aria-hidden="true">5.7.4.</strong> Query Phase ðŸš§</a></li></ol></li><li class="chapter-item expanded "><a href="ch05-08-starks-protocol-rust.html"><strong aria-hidden="true">5.8.</strong> STARKs Protocol (Rust) ðŸš§</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="ch05-08-01-trace-low-degree-extension-rust.html"><strong aria-hidden="true">5.8.1.</strong> Trace/Low Degree Extension ðŸš§</a></li><li class="chapter-item expanded "><a href="ch05-08-02-constraints-rust.html"><strong aria-hidden="true">5.8.2.</strong> Constraints ðŸš§</a></li><li class="chapter-item expanded "><a href="ch05-08-03-fri-commitments-rust.html"><strong aria-hidden="true">5.8.3.</strong> FRI Commitments ðŸš§</a></li><li class="chapter-item expanded "><a href="ch05-08-04-query-phase-rust.html"><strong aria-hidden="true">5.8.4.</strong> Query Phase ðŸš§</a></li></ol></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">The Starknet Book</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <p><em>Copyright 2019 Starkware Industries Ltd. Licensed under the Apache
License, Version 2.0 (the &quot;License&quot;). You may not use this file except
in compliance with the License. You may obtain a copy of the License at
<a href="https://www.starkware.co/open-source-license/">https://www.starkware.co/open-source-license/</a> Unless required by
applicable law or agreed to in writing, software distributed under the
License is distributed on an &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR
CONDITIONS OF ANY KIND, either express or implied. See the License for
the specific language governing permissions and limitations under the
License.</em></p>
<h1 id="part-1-trace-and-low-degree-extension"><a class="header" href="#part-1-trace-and-low-degree-extension">Part 1: Trace and Low-Degree Extension</a></h1>
<ul>
<li>
<p><a href="https://www.youtube.com/watch?v=Y0uJz9VL3Fo">Video Lecture
(youtube)</a></p>
</li>
<li>
<p><a href="https://starkware.co/wp-content/uploads/2021/12/STARK101-Part1.pdf">Slides
(PDF)</a></p>
</li>
</ul>
<p>Today we will develop a STARK prover for the FibonacciSq sequence over a
finite field. The FibonacciSq sequence is defined by the recurrence
relation . By the end of the day, your code will produce a <em>STARK</em> proof
attesting to the following statement: <strong>I know a field element such that
the 1023rd element of the FibonacciSq sequence starting with is</strong> .</p>
<h2 id="the-basics"><a class="header" href="#the-basics">The Basics</a></h2>
<h3 id="fieldelement-class"><a class="header" href="#fieldelement-class">FieldElement class</a></h3>
<p>We use our <code>+FieldElement+</code> class to represent field elements. You can
construct instances of <code>+FieldElement+</code> from integers, and then add,
multiply, divide, get inverse, and so on. The underlying field of this
class is (), so all operations are done modulo 3221225473. Try it by
running the following cell (shift<br />
enter):</p>
<pre><code>from field import FieldElement
FieldElement(3221225472) + FieldElement(10)
</code></pre>
<h1 id="fibonaccisq-trace"><a class="header" href="#fibonaccisq-trace">FibonacciSq Trace</a></h1>
<p>To start, letâ€™s construct a list <code>+a+</code> of length 1023, whose first two
elements will be FieldElement objects representing 1 and 3141592,
respectively. The next 1021 elements will be the FibonacciSq sequence
induced by these two elements. <code>+a+</code> is called the trace of FibonacciSq,
or, when the context is clear, the trace. We can calculate <code>+a+</code> as
follows:</p>
<pre><code>a = [FieldElement(1), FieldElement(3141592)]
while len(a) &lt; 1023:
    a.append(a[-2] * a[-2] + a[-1] * a[-1])
</code></pre>
<h1 id="test-your-code"><a class="header" href="#test-your-code">Test Your Code</a></h1>
<p>Run the next cell to test that you have filled <code>+a+</code> correctly. Note
that this is in fact a verifier, albeit very naive and non-succinct one,
as it goes over the sequence, element by element, making sure it is
correct.</p>
<pre><code>assert len(a) == 1023, 'The trace must consist of exactly 1023 elements.'
assert a[0] == FieldElement(1), 'The first element in the trace must be the unit element.'
for i in range(2, 1023):
    assert a[i] == a[i - 1] * a[i - 1] + a[i - 2] * a[i - 2], f'The FibonacciSq recursion rule does not apply for index {i}'
assert a[1022] == FieldElement(2338775057), 'Wrong last element!'
print('Success!')
</code></pre>
<h1 id="thinking-of-polynomials"><a class="header" href="#thinking-of-polynomials">Thinking of Polynomials</a></h1>
<p>We now want to think of the sequence as the evaluation of some, yet
unknown, polynomial of degree 1022 (due to the Unisolvence Theorem). We
will choose the domain to be some subgroup of size 1024, for reasons
that will become clear later.</p>
<p>(Recall that denotes the multiplicative group of , which we get from by
omitting the zero element with the induced multiplication from the
field. A subgroup of size 1024 exists because is a cyclic group of size
, so it contains a subgroup of size for any ).</p>
<h2 id="find-a-group-of-size-1024"><a class="header" href="#find-a-group-of-size-1024">Find a Group of Size 1024</a></h2>
<p>If we find an element whose (multiplicative) order is 1024, then will
generate such a group. The class <code>+FieldElement+</code> provides a static
method <code>+generator()+</code> which returns an element that generates (whose
order is ).</p>
<ol>
<li>
<p>Use it to obtain a generator for .</p>
</li>
<li>
<p>Create a list called <code>+G+</code> with all the elements of , such that :=
g^i].</p>
</li>
</ol>
<p><em>Hint: When divides , generates a group of size , and the n-th power of
some <code>+FieldElement+</code> can be computed by calling <code>+x ** n+</code>.</em></p>
<p>Solution:</p>
<pre><code>g = FieldElement.generator() ** (3 * 2 ** 20)
G = [g ** i for i in range(1024)]
</code></pre>
<p>Run the next cell to test your code.</p>
<pre><code># Checks that g and G are correct.
assert g.is_order(1024), 'The generator g is of wrong order.'
b = FieldElement(1)
for i in range(1023):
    assert b == G[i], 'The i-th place in G is not equal to the i-th power of g.'
    b = b * g
    assert b != FieldElement(1), f'g is of order {i + 1}'

if b * g == FieldElement(1):
    print('Success!')
else:
    print('g is of order &gt; 1024')
</code></pre>
<h1 id="polynomial-class"><a class="header" href="#polynomial-class">Polynomial class</a></h1>
<p>We provide you with a class called <code>+Polynomial+</code>. The simplest way to
construct a <code>+Polynomial+</code> is by using the variable <code>+X+</code> (note that
itâ€™s a capital <code>+X+</code>) which represents the formal variable :</p>
<pre><code>from polynomial import X
# The polynomial 2x^2 + 1.
p = 2*X**2 + 1
# Evaluate p at 2:
print(p(2))
</code></pre>
<h1 id="interpolating-a-polynomial"><a class="header" href="#interpolating-a-polynomial">Interpolating a Polynomial</a></h1>
<p>Our <code>+polynomial+</code> module provides a Lagrange interpolation function,
whose arguments are:</p>
<ul>
<li>
<p>x_values: x-values of G that the polynomialâ€™s values for them is
known. [List]</p>
</li>
<li>
<p>y_values: the corresponding y-values. [List]</p>
</li>
</ul>
<p>It returns the unique <code>+Polynomial+</code> of degree &lt; <code>+len(x_values)+</code>
instance that evaluates to <code>+y_values[i]+</code> on <code>+x_values[i]+</code> for all i.</p>
<p>Run the following cell to get help on the function <code>+interpolate_poly+</code>.</p>
<pre><code>from polynomial import interpolate_poly
interpolate_poly?
</code></pre>
<p>Suppose that <code>+a+</code> contains the values of some polynomial over <code>+G+</code>
(except for <code>+G[-1]+</code>, since <code>+a+</code> is one element shorter). Use
<code>+interpolate_poly()+</code> to get <code>+f+</code> and get its value at
<code>+FieldElement(2)+</code>.</p>
<p>Solution:</p>
<pre><code>f = interpolate_poly(G[:-1], a)
v = f(2)
</code></pre>
<p>Run test:</p>
<pre><code>assert v == FieldElement(1302089273)
print('Success!')
</code></pre>
<h1 id="evaluating-on-a-larger-domain"><a class="header" href="#evaluating-on-a-larger-domain">Evaluating on a Larger Domain</a></h1>
<p>The trace, viewed as evaluations of a polynomial on , can now be
extended by evaluating over a larger domain, thereby creating a
Reed-Solomon error correction code.</p>
<h2 id="cosets"><a class="header" href="#cosets">Cosets</a></h2>
<p>To that end, we must decide on a larger domain on which will be
evaluated. We will work with a domain that is 8 times larger than . A
natural choice for such a domain is to take some group of size 8192
(which exists because 8192 divides ), and shift it by the generator of ,
thereby obtaining a <a href="https://en.wikipedia.org/wiki/Coset">coset</a> of .</p>
<p>Create a list called <code>+H+</code> of the elements of , and multiply each of
them by the generator of to obtain a list called <code>+eval_domain+</code>. In
other words, eval_domain = for the generator of and the generator of .</p>
<p>Hint: You already know how to obtain - similarly to the way we got a few
minutes ago.</p>
<p>Solution:</p>
<pre><code>w = FieldElement.generator()
h = w ** ((2 ** 30 * 3) // 8192)
H = [h ** i for i in range(8192)]
eval_domain = [w * x for x in H]
</code></pre>
<p>Run test:</p>
<pre><code>from hashlib import sha256
assert len(set(eval_domain)) == len(eval_domain)
w = FieldElement.generator()
w_inv = w.inverse()
assert '55fe9505f35b6d77660537f6541d441ec1bd919d03901210384c6aa1da2682ce' == sha256(str(H[1]).encode()).hexdigest(),\
    'H list is incorrect. H[1] should be h (i.e., the generator of H).'
for i in range(8192):
    assert ((w_inv * eval_domain[1]) ** i) * w == eval_domain[i]
print('Success!')
</code></pre>
<h1 id="evaluate-on-a-coset"><a class="header" href="#evaluate-on-a-coset">Evaluate on a Coset</a></h1>
<p>Time to use <code>+interpolate_poly+</code> and <code>+Polynomial.poly+</code> to evaluate
over the coset. Note that it is implemented fairly naively in our Python
module, so interpolation may take up to a minute. Indeed - interpolating
and evaluating the trace polynomial is one of the most
computationally-intensive steps in the STARK protocol, even when using
more efficient methods (e.g. FFT).</p>
<p>Solution:</p>
<pre><code>f = interpolate_poly(G[:-1], a)
f_eval = [f(d) for d in eval_domain]
</code></pre>
<p>Run test:</p>
<pre><code># Test against a precomputed hash.
from hashlib import sha256
from channel import serialize
assert '1d357f674c27194715d1440f6a166e30855550cb8cb8efeb72827f6a1bf9b5bb' == sha256(serialize(f_eval).encode()).hexdigest()
print('Success!')
</code></pre>
<h1 id="commitments"><a class="header" href="#commitments">Commitments</a></h1>
<p>We will use <a href="https://en.wikipedia.org/wiki/SHA-2">Sha256</a>-based <a href="https://en.wikipedia.org/wiki/Merkle_tree">Merkle
Trees</a> as our commitment
scheme. A simple implementation of it is available to you in the
<code>+MerkleTree+</code> class. Run the next cell (for the sake of this tutorial,
this also serves as a test for correctness of the entire computation so
far):</p>
<pre><code>from merkle import MerkleTree
f_merkle = MerkleTree(f_eval)
assert f_merkle.root == '6c266a104eeaceae93c14ad799ce595ec8c2764359d7ad1b4b7c57a4da52be04'
print('Success!')
</code></pre>
<h1 id="channel"><a class="header" href="#channel">Channel</a></h1>
<p>Theoretically, a STARK proof system is a protocol for interaction
between two parties - a prover and a verifier. In practice, we convert
this interactive protocol into a non-interactive proof using the
<a href="https://en.wikipedia.org/wiki/Fiat%E2%80%93Shamir_heuristic">Fiat-Shamir
Heuristic</a>.
In this tutorial you will use the <code>+Channel+</code> class, which implements
this transformation. This channel replaces the verifier in the sense
that the prover (which you are writing) will send data, and receive
random numbers or random <code>+FieldElement+</code> instances.</p>
<p>This simple piece of code instantiates a channel object, sends the root
of your Merkle Tree to it. Later, the channel object can be called to
provide random numbers or random field elements.</p>
<pre><code>from channel import Channel
channel = Channel()
channel.send(f_merkle.root)
</code></pre>
<p>Lastly - you can retrieve the proof-so-far (i.e., everything that was
passed in the channel up until a certain point) by printing the member
<code>+Channel.proof+</code>.</p>
<pre><code>print(channel.proof)
</code></pre>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="ch05-07-starks-protocol-python.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next" href="ch05-07-02-constraints-python.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="ch05-07-starks-protocol-python.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next" href="ch05-07-02-constraints-python.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
